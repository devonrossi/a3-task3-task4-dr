---
title: "Sea Urchins"
author: "Devon Rossi"
date: "10/25/2021"
output: html_document
---
#Overview
In this task, you will use version control, project management, and data wrangling, analysis & visualization skills to explore red and purple urchins recorded by Santa Barbara Coastal Long Term Ecological Research program divers, while practicing version control and project management.

Data: Reed, D. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b. 

#Setup
```{r setup, include = TRUE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE)

#Attacy library here, tidyverse, and janitor packages
library(here)
library(tidyverse)
library(janitor)
library(kableExtra) #attach kableExtra
library(lubridate) #attach lubridate to edit dates

```

#Read in the data
```{r}
#Read in the sea urchins data
urchins <- read_csv(here("data", "urchins.csv"))
#Title data, read_csv, here function to call in data and specific data set
```
#Clean up names to lower_snakecase
```{r}
sb_urchins <- urchins %>% #clean dataset using clean_names()
  clean_names()
```


##Section 1: Size comparisons, purple and red urchins 

# Data Visualization
```{r, fig.cap = "Figure 1: Purple and Red Urchin: Distribution of Sizes"}
#compare the distribution of sizes between purple and red urchins with a finalized, faceted histogram 

ggplot(data = sb_urchins, aes(x = size)) + 
  geom_histogram(aes(fill = common_name, bins = 14)) + #bins = 12
  facet_wrap(~ common_name) + #facet_wrap: adds 1d sequence of panels into 2d
  labs (x = "Size (cm)", #units are centimeters
        y = "Sea Urchin Species", 
        title = "Size Comparison: Purple and Red Urchin Sizes") +
  theme()
```

# Descriptive statistics table
```{r}
sb_urchins_stats <- sb_urchins %>% #title your summary table; pull from data set
  group_by(common_name) %>%  #group by to find stats for purple and red urchins (round)
  summarize(mean_size = round(mean(size), 2), 
            median_size = round(median(size), 2),
            sd_size = round(sd(size), 2),
            sample_size = n())
sb_urchins_stats #View summary table

#Update column names
sb_urchins_stats %>% 
  kable(col.names = c("Species",
        "Mean Size (cm)",
        "Median Size (cm)",
        "SD Size (cm)",
        "Sample Size (cm)"),
        caption = "Table 1: SB Urchins Statistics: Mean, Median, SD, Sample Size" )

```

#Table 1 Description
From Table 1, I observed red urchin population had a larger distribution in size than the purple urchin population. The SD is greater for red urchin population versus purple urchin population (1.89cm compared to 1.18cm). Red urchin mean size is 6.78cm compared to purple urchin mean size of 4.47cm, meaning it is 2.31cm greater. We can assume our sample populations were collected from sample sizes with different means. 

   
#Section 2: Explore purple urchin counts by site and year
```{r}
purple_urchins <- sb_urchins %>% 
  filter(common_name == "Purple Urchin") %>%
  mutate(date_new = mdy(date)) %>% #tell R it is a class
  mutate(year = year(date_new)) %>% 
  mutate(site_full = case_when(site == "NAPL" ~ "Naples Reef",
                               site == "AQUE" ~ "Arroyo Quemado Reef",
                               site == "CARP" ~ "Carpinteria Reef",
                               site == "MOHK" ~ "Mohawk Reef",
                               site == "IVEE" ~ "Isla Vista Reef"))

```

# Store Table: Total # of Purple Urchins Observed by Site & Year
```{r}
# Store table containing total # of purple urchins observed by site and year
purple_urchins_site_year <- purple_urchins %>% 
  group_by(site_full, year) %>% 
  summarize(count = n())

purple_urchins_site_year

```

# Data Visualization
```{r, fig.cap = "Figure 2: Purple urchin counts recorded at each site from 2008-2020"}
#Graph of counts of purple urchins recorded at each site over time for years included in study + figure caption
ggplot(data = purple_urchins_site_year,
       aes(x = year,
           y = count,
           color = site_full)) +
  geom_line() +
  labs(x = "Year",
       y = "Sample Count",
       title = "Purple Urchins: Site and Year") +
  scale_color_discrete(name = "Site") +
  theme() +
  scale_x_continuous(breaks = 2008:2020)
```
#Description of Graph:
This line graph illustrates the changes in purple urchin sample sizes throughout 5 locations in SB from 2008-2020. In order to understand if the changes in counts by year are reflective of actual changes in urchin population, we would need to calculate the summary statistics to understand if it falls within a normal distribution. By performing a t-test, we would be able to visualize whether the differences between sample means indicate actual changes within the purple urchin population.
